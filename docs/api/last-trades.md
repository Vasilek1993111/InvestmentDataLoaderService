# API Последних Сделок

Документация для работы с последними обезличенными сделками.

## Базовый URL
```
http://localhost:8087/api/last-trades
```

## Эндпоинты

### POST /api/last-trades
Загрузка последних сделок.

**Параметры:**
- `request` (body) - объект запроса с параметрами загрузки сделок

```bash
curl -X POST "http://localhost:8087/api/last-trades" \
  -H "Content-Type: application/json" \
  -d '{
    "figis": ["BBG004730N88"],
    "from": "2024-01-15T09:00:00",
    "to": "2024-01-15T18:45:00"
  }'
```

**Ответ (пример):**
```json
{
  "success": true,
  "message": "Загрузка обезличенных сделок запущена в фоновом режиме",
  "timestamp": "2024-01-15T18:30:00"
}
```

## Особенности

### Асинхронная обработка
- Загрузка сделок выполняется в фоновом режиме
- Возвращается немедленный ответ о запуске процесса
- Использует `LastTradesService` для асинхронной обработки

### Источники данных
- Получает данные из T-INVEST API
- Сохраняет данные в соответствующие таблицы
- Обрабатывает обезличенные сделки

### Обработка ошибок
- Все методы возвращают структурированные ответы с полем `success`
- В случае ошибки возвращается HTTP 500 с описанием проблемы
- Логируются детали ошибок в консоль

## Коды ответов

- `200 OK` - Успешное выполнение
- `500 Internal Server Error` - Внутренняя ошибка сервера

## Примеры использования

### Загрузка сделок по инструментам
```bash
curl -X POST "http://localhost:8087/api/last-trades" \
  -H "Content-Type: application/json" \
  -d '{
    "figis": ["BBG004730N88", "BBG004730ZJ9"],
    "from": "2024-01-15T09:00:00",
    "to": "2024-01-15T18:45:00"
  }'
```

### Загрузка сделок за период
```bash
curl -X POST "http://localhost:8087/api/last-trades" \
  -H "Content-Type: application/json" \
  -d '{
    "from": "2024-01-15T09:00:00",
    "to": "2024-01-15T18:45:00"
  }'
```
