# API ‚Äî –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (`/api/instruments`)

## –û–±–∑–æ—Ä

API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –µ–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç—Ä–µ–º—è —Ç–∏–ø–∞–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤:
- **–ê–∫—Ü–∏–∏ (Shares)** - –æ–±—ã–∫–Ω–æ–≤–µ–Ω–Ω—ã–µ –∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–∫—Ü–∏–∏
- **–§—å—é—á–µ—Ä—Å—ã (Futures)** - –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã  
- **–ò–Ω–¥–∏–∫–∞—Ç–∏–≤—ã (Indicatives)** - –∏–Ω–¥–∏–∫–∞—Ç–∏–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- **–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤** - –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ API Tinkoff –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è** - –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º (–±–∏—Ä–∂–∞, –≤–∞–ª—é—Ç–∞, —Ç–∏–∫–µ—Ä, FIGI)
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ** - –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤ –ë–î —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- **–ü–æ–∏—Å–∫** - –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –ø–æ FIGI –∏–ª–∏ —Ç–∏–∫–µ—Ä—É
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

**–ë–∞–∑–æ–≤—ã–π URL:** `http://localhost:8083/api/instruments` (PROD) / `http://localhost:8087/api/instruments` (TEST)

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –¥–∞–Ω–Ω—ã–µ –∏–∑ API –∫—ç—à–∏—Ä—É—é—Ç—Å—è –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–≥—Ä–µ–≤** - –∫—ç—à –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≥—Ä–µ–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- **–ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤** - –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –Ω–µ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è –≤ –ë–î
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ** - API —Å–∞–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç FIGI –∏–ª–∏ —Ç–∏–∫–µ—Ä
- **Fallback** - –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ REST API –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î

---

## –ê–∫—Ü–∏–∏ (Shares)

### GET /api/instruments/shares

–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∞–∫—Ü–∏–π —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö:

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `source` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö: `"api"` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) –∏–ª–∏ `"database"`
- `status` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Å—Ç–∞—Ç—É—Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞: `INSTRUMENT_STATUS_ACTIVE`, `INSTRUMENT_STATUS_BASE`
- `exchange` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –±–∏—Ä–∂–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `MOEX`, `SPB`)
- `currency` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –≤–∞–ª—é—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `RUB`, `USD`, `EUR`)
- `ticker` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Ç–∏–∫–µ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `SBER`, `GAZP`)
- `figi` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `filter` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (—Ç–æ–ª—å–∫–æ –¥–ª—è `source=database`)

**–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```bash
# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑ API (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
curl "http://localhost:8083/api/instruments/shares?exchange=MOEX&currency=RUB"

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
curl "http://localhost:8083/api/instruments/shares?source=database&exchange=MOEX"

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–æ–º
curl -X POST "http://localhost:8083/api/instruments/shares?source=database" \
  -H "Content-Type: application/json" \
  -d '{
    "exchange": "MOEX",
    "currency": "RUB",
    "sector": "Technology",
    "tradingStatus": "TRADING_STATUS_ACTIVE"
  }'
```

**–û—Ç–≤–µ—Ç (–ø—Ä–∏–º–µ—Ä):**
```json
[
  {
    "figi": "BBG004730N88",
    "ticker": "SBER",
    "name": "–°–±–µ—Ä–±–∞–Ω–∫",
    "currency": "RUB",
    "exchange": "MOEX",
    "sector": "Financial Services",
    "tradingStatus": "SECURITY_TRADING_STATUS_NORMAL_TRADING"
  }
]
```

### GET /api/instruments/shares/{identifier}

–ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ü–∏–∏ –ø–æ FIGI –∏–ª–∏ —Ç–∏–∫–µ—Ä—É –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞:
- –ï—Å–ª–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª–∏–Ω–Ω–µ–µ 10 —Å–∏–º–≤–æ–ª–æ–≤ –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç `-` –∏–ª–∏ `_` ‚Üí –ø–æ–∏—Å–∫ –ø–æ FIGI
- –ò–Ω–∞—á–µ ‚Üí –ø–æ–∏—Å–∫ –ø–æ —Ç–∏–∫–µ—Ä—É

**–ü—Ä–∏–º–µ—Ä—ã:**
```bash
# –ü–æ FIGI
curl "http://localhost:8083/api/instruments/shares/BBG004730N88"

# –ü–æ —Ç–∏–∫–µ—Ä—É
curl "http://localhost:8083/api/instruments/shares/SBER"
```

**–û—Ç–≤–µ—Ç (–ø—Ä–∏–º–µ—Ä):**
```json
{
  "figi": "BBG004730N88",
  "ticker": "SBER",
  "name": "–°–±–µ—Ä–±–∞–Ω–∫",
  "currency": "RUB",
  "exchange": "MOEX",
  "sector": "Financial Services",
  "tradingStatus": "SECURITY_TRADING_STATUS_NORMAL_TRADING"
}
```

### POST /api/instruments/shares

–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–∫—Ü–∏–π –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ñ–∏–ª—å—Ç—Ä–∞–º —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "status": "INSTRUMENT_STATUS_ACTIVE",
  "exchange": "MOEX",
  "currency": "RUB",
  "ticker": "SBER",
  "figi": "BBG004730N88"
}
```

**–ü—Ä–∏–º–µ—Ä:**
```bash
curl -X POST "http://localhost:8083/api/instruments/shares" \
  -H "Content-Type: application/json" \
  -d '{
    "status": "INSTRUMENT_STATUS_ACTIVE",
    "exchange": "MOEX",
    "currency": "RUB"
  }'
```

**–û—Ç–≤–µ—Ç (–ø—Ä–∏–º–µ—Ä):**
```json
{
  "success": true,
  "message": "–£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ 5 –Ω–æ–≤—ã—Ö –∞–∫—Ü–∏–π –∏–∑ 10 –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö.",
  "totalRequested": 10,
  "newItemsSaved": 5,
  "existingItemsSkipped": 5,
  "invalidItemsFiltered": 0,
  "missingFromApi": 0,
  "savedItems": [
    {
      "figi": "BBG004730N88",
      "ticker": "SBER",
      "name": "–°–±–µ—Ä–±–∞–Ω–∫",
      "currency": "RUB",
      "exchange": "MOEX",
      "sector": "Financial Services",
      "tradingStatus": "SECURITY_TRADING_STATUS_NORMAL_TRADING"
    }
  ]
}
```

---

## –§—å—é—á–µ—Ä—Å—ã (Futures)

### GET /api/instruments/futures

–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ñ—å—é—á–µ—Ä—Å–æ–≤ –∏–∑ Tinkoff API —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π. –î–∞–Ω–Ω—ã–µ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `status` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Å—Ç–∞—Ç—É—Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞: `INSTRUMENT_STATUS_ACTIVE`, `INSTRUMENT_STATUS_BASE`
- `exchange` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –±–∏—Ä–∂–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `MOEX`, `SPB`)
- `currency` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –≤–∞–ª—é—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `RUB`, `USD`, `EUR`)
- `ticker` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Ç–∏–∫–µ—Ä —Ñ—å—é—á–µ—Ä—Å–∞
- `assetType` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Ç–∏–ø –±–∞–∑–æ–≤–æ–≥–æ –∞–∫—Ç–∏–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `COMMODITY`, `CURRENCY`, `EQUITY`)

**–ü—Ä–∏–º–µ—Ä:**
```bash
curl "http://localhost:8083/api/instruments/futures?exchange=MOEX&currency=RUB&assetType=COMMODITY"
```

**–û—Ç–≤–µ—Ç (–ø—Ä–∏–º–µ—Ä):**
```json
[
  {
    "figi": "FUTSI1224000",
    "ticker": "Si-12.24",
    "assetType": "CURRENCY",
    "basicAsset": "USD/RUB",
    "currency": "RUB",
    "exchange": "MOEX"
  }
]
```

### GET /api/instruments/futures/{identifier}

–ü–æ–ª—É—á–µ–Ω–∏–µ —Ñ—å—é—á–µ—Ä—Å–∞ –ø–æ FIGI –∏–ª–∏ —Ç–∏–∫–µ—Ä—É –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –º–µ—Ç–æ–¥—É –¥–ª—è –∞–∫—Ü–∏–π.

**–ü—Ä–∏–º–µ—Ä—ã:**
```bash
# –ü–æ FIGI
curl "http://localhost:8083/api/instruments/futures/FUTSI1224000"

# –ü–æ —Ç–∏–∫–µ—Ä—É
curl "http://localhost:8083/api/instruments/futures/Si-12.24"
```

**–û—Ç–≤–µ—Ç (–ø—Ä–∏–º–µ—Ä):**
```json
{
  "figi": "FUTSI1224000",
  "ticker": "Si-12.24",
  "assetType": "CURRENCY",
  "basicAsset": "USD/RUB",
  "currency": "RUB",
  "exchange": "MOEX"
}
```

### POST /api/instruments/futures

–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ—å—é—á–µ—Ä—Å–æ–≤ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ñ–∏–ª—å—Ç—Ä–∞–º —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "status": "INSTRUMENT_STATUS_ACTIVE",
  "exchange": "MOEX",
  "currency": "RUB",
  "ticker": "Si-12.24",
  "assetType": "CURRENCY"
}
```

**–ü—Ä–∏–º–µ—Ä:**
```bash
curl -X POST "http://localhost:8083/api/instruments/futures" \
  -H "Content-Type: application/json" \
  -d '{
    "status": "INSTRUMENT_STATUS_ACTIVE",
    "exchange": "MOEX",
    "currency": "RUB",
    "assetType": "CURRENCY"
  }'
```

**–û—Ç–≤–µ—Ç (–ø—Ä–∏–º–µ—Ä):**
```json
{
  "success": true,
  "message": "–£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ 3 –Ω–æ–≤—ã—Ö —Ñ—å—é—á–µ—Ä—Å–∞ –∏–∑ 8 –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö.",
  "totalRequested": 8,
  "newItemsSaved": 3,
  "existingItemsSkipped": 5,
  "invalidItemsFiltered": 0,
  "missingFromApi": 0,
  "savedItems": [
    {
      "figi": "FUTSI1224000",
      "ticker": "Si-12.24",
      "assetType": "CURRENCY",
      "basicAsset": "USD/RUB",
      "currency": "RUB",
      "exchange": "MOEX"
    }
  ]
}
```

---

## –ò–Ω–¥–∏–∫–∞—Ç–∏–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (Indicatives)

### GET /api/instruments/indicatives

–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–∏–≤–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∏–∑ Tinkoff REST API –∏–ª–∏ –ë–î (fallback). –î–∞–Ω–Ω—ã–µ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `exchange` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –±–∏—Ä–∂–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `MOEX`, `SPB`)
- `currency` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –≤–∞–ª—é—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `RUB`, `USD`, `EUR`)
- `ticker` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Ç–∏–∫–µ—Ä –∏–Ω–¥–∏–∫–∞—Ç–∏–≤–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `figi` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞

**–ü—Ä–∏–º–µ—Ä:**
```bash
curl "http://localhost:8083/api/instruments/indicatives?exchange=MOEX&currency=RUB"
```

**–û—Ç–≤–µ—Ç (–ø—Ä–∏–º–µ—Ä):**
```json
[
  {
    "figi": "BBG00QPYJ5X0",
    "ticker": "IMOEX",
    "name": "–ò–Ω–¥–µ–∫—Å –ú–æ—Å–ë–∏—Ä–∂–∏",
    "currency": "RUB",
    "exchange": "MOEX",
    "classCode": "SPBXM",
    "uid": "e6123145-9665-43e0-8413-cd61d8e6e372",
    "sellAvailableFlag": true,
    "buyAvailableFlag": true
  }
]
```

### GET /api/instruments/indicatives/{identifier}

–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–∏–≤–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –ø–æ FIGI –∏–ª–∏ —Ç–∏–∫–µ—Ä—É.

API –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –º–µ—Ç–æ–¥–∞–º –¥–ª—è –∞–∫—Ü–∏–π –∏ —Ñ—å—é—á–µ—Ä—Å–æ–≤.

**–ü—Ä–∏–º–µ—Ä—ã:**
```bash
# –ü–æ FIGI
curl "http://localhost:8083/api/instruments/indicatives/BBG00QPYJ5X0"

# –ü–æ —Ç–∏–∫–µ—Ä—É
curl "http://localhost:8083/api/instruments/indicatives/IMOEX"
```

**–û—Ç–≤–µ—Ç (–ø—Ä–∏–º–µ—Ä):**
```json
{
  "figi": "BBG00QPYJ5X0",
  "ticker": "IMOEX",
  "name": "–ò–Ω–¥–µ–∫—Å –ú–æ—Å–ë–∏—Ä–∂–∏",
  "currency": "RUB",
  "exchange": "MOEX",
  "classCode": "SPBXM",
  "uid": "e6123145-9665-43e0-8413-cd61d8e6e372",
  "sellAvailableFlag": true,
  "buyAvailableFlag": true
}
```

### POST /api/instruments/indicatives

–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–∏–≤–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ñ–∏–ª—å—Ç—Ä–∞–º —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "exchange": "MOEX",
  "currency": "RUB",
  "ticker": "IMOEX",
  "figi": "BBG00QPYJ5X0"
}
```

**–ü—Ä–∏–º–µ—Ä:**
```bash
curl -X POST "http://localhost:8083/api/instruments/indicatives" \
  -H "Content-Type: application/json" \
  -d '{
    "exchange": "MOEX",
    "currency": "RUB",
    "ticker": "IMOEX"
  }'
```

**–û—Ç–≤–µ—Ç (–ø—Ä–∏–º–µ—Ä):**
```json
{
  "success": true,
  "message": "–£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ 2 –Ω–æ–≤—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–∏–≤–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –∏–∑ 5 –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö.",
  "totalRequested": 5,
  "newItemsSaved": 2,
  "existingItemsSkipped": 3,
  "invalidItemsFiltered": 0,
  "missingFromApi": 0,
  "savedItems": [
    {
      "figi": "BBG00QPYJ5X0",
      "ticker": "IMOEX",
      "name": "–ò–Ω–¥–µ–∫—Å –ú–æ—Å–ë–∏—Ä–∂–∏",
      "currency": "RUB",
      "exchange": "MOEX",
      "classCode": "SPBXM",
      "uid": "e6123145-9665-43e0-8413-cd61d8e6e372",
      "sellAvailableFlag": true,
      "buyAvailableFlag": true
    }
  ]
}
```

---

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### GET /api/instruments/count

–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤ –ë–î –ø–æ —Ç–∏–ø–∞–º.

**–ü—Ä–∏–º–µ—Ä:**
```bash
curl "http://localhost:8083/api/instruments/count"
```

**–û—Ç–≤–µ—Ç (–ø—Ä–∏–º–µ—Ä):**
```json
{
  "shares": 150,
  "futures": 45,
  "indicatives": 12,
  "total": 207
}
```

---

## –°–≤—è–∑–∞–Ω–Ω—ã–µ API

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–µ–º
–î–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫—ç—à–µ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π API: **[Cache API](/api/cache)**

–í–∫–ª—é—á–∞–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏:
- –ü—Ä–æ–≥—Ä–µ–≤ –∫—ç—à–∞ (`POST /api/cache/warmup`)
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∫—ç—à–∞ (`GET /api/cache/content`)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞ (`GET /api/cache/stats`)
- –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ (`DELETE /api/cache/clear`)

---

## –ö–æ–¥—ã –æ—à–∏–±–æ–∫

- `200 OK` - –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å
- `404 Not Found` - –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
- `400 Bad Request` - –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
- `500 Internal Server Error` - –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **InstrumentsController** - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–ª—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- **InstrumentService** - —Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏
- **@Transactional** - –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CachedInstrumentService

### –¢–∏–ø—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- **SHARES** - –∞–∫—Ü–∏–∏ (–æ–±—ã–∫–Ω–æ–≤–µ–Ω–Ω—ã–µ –∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)
- **FUTURES** - —Ñ—å—é—á–µ—Ä—Å—ã (–ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã)
- **INDICATIVES** - –∏–Ω–¥–∏–∫–∞—Ç–∏–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- **Tinkoff API** - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ API
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- **–ü–æ –±–∏—Ä–∂–µ** - MOEX, SPB –∏ –¥—Ä—É–≥–∏–µ
- **–ü–æ –≤–∞–ª—é—Ç–µ** - RUB, USD, EUR –∏ –¥—Ä—É–≥–∏–µ
- **–ü–æ —Ç–∏–∫–µ—Ä—É** - —Ç–æ—á–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ —Å–∏–º–≤–æ–ª—É
- **–ü–æ FIGI** - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- **–ü–æ —Å—Ç–∞—Ç—É—Å—É** - –∞–∫—Ç–∏–≤–Ω—ã–µ, –±–∞–∑–æ–≤—ã–µ –∏ –¥—Ä—É–≥–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
- **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞** - FIGI –∏–ª–∏ —Ç–∏–∫–µ—Ä
- **–ü—Ä–æ–≥—Ä–µ–≤ –∫—ç—à–∞** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- **–ó–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è
- **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞** - –ø–æ —Ç–∏–∫–µ—Ä—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

---

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
```bash
# –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ü–∏–π
curl "http://localhost:8083/api/instruments/shares?exchange=MOEX&currency=RUB"

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ñ—å—é—á–µ—Ä—Å–æ–≤
curl "http://localhost:8083/api/instruments/futures?exchange=MOEX&currency=RUB"

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–∏–≤–æ–≤
curl "http://localhost:8083/api/instruments/indicatives?exchange=MOEX&currency=RUB"
```

### –ü–æ–∏—Å–∫ –ø–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—É
```bash
# –ü–æ–∏—Å–∫ –∞–∫—Ü–∏–∏ –ø–æ FIGI
curl "http://localhost:8083/api/instruments/shares/BBG004730N88"

# –ü–æ–∏—Å–∫ –∞–∫—Ü–∏–∏ –ø–æ —Ç–∏–∫–µ—Ä—É
curl "http://localhost:8083/api/instruments/shares/SBER"

# –ü–æ–∏—Å–∫ —Ñ—å—é—á–µ—Ä—Å–∞
curl "http://localhost:8083/api/instruments/futures/FUTSI1224000"

# –ü–æ–∏—Å–∫ –∏–Ω–¥–∏–∫–∞—Ç–∏–≤–∞
curl "http://localhost:8083/api/instruments/indicatives/BBG00QPYJ5X0"
```

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
```bash
# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–∫—Ü–∏–π
curl -X POST "http://localhost:8083/api/instruments/shares" \
  -H "Content-Type: application/json" \
  -d '{"exchange": "MOEX", "currency": "RUB"}'

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ—å—é—á–µ—Ä—Å–æ–≤
curl -X POST "http://localhost:8083/api/instruments/futures" \
  -H "Content-Type: application/json" \
  -d '{"exchange": "MOEX", "currency": "RUB", "assetType": "CURRENCY"}'

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–∏–≤–æ–≤
curl -X POST "http://localhost:8083/api/instruments/indicatives" \
  -H "Content-Type: application/json" \
  -d '{"exchange": "MOEX", "currency": "RUB"}'
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
```bash
# –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
curl "http://localhost:8083/api/instruments/count"
```

---

## ‚ö†Ô∏è –ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤

### –£—Å–ø–µ—à–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
- **200 OK** - –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã –∏–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ

### –û—à–∏–±–∫–∏
- **404 Not Found** - –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
- **400 Bad Request** - –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
- **500 Internal Server Error** - –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### –ü—Ä–∏–º–µ—Ä—ã –æ—à–∏–±–æ–∫
```json
{
  "error": "–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω",
  "message": "–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º SBER –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö",
  "timestamp": "2024-01-15T18:30:00"
}
```

---

## üîÑ –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
1. **–ó–∞–ø—Ä–æ—Å** - GET –∑–∞–ø—Ä–æ—Å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
2. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞** - API –∏–ª–∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
3. **–û–±—Ä–∞–±–æ—Ç–∫–∞** - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
4. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è** - –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–∞
5. **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞** - —É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–Ω–∏–µ –ø–æ —Ç–∏–∫–µ—Ä—É
6. **–û—Ç–≤–µ—Ç** - –≤–æ–∑–≤—Ä–∞—Ç –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç—É

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
1. **–ó–∞–ø—Ä–æ—Å** - POST –∑–∞–ø—Ä–æ—Å —Å —Ñ–∏–ª—å—Ç—Ä–æ–º
2. **–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑ API** - –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Tinkoff API
3. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è** - –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–∞
4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤** - –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö
5. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ** - –∑–∞–ø–∏—Å—å –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
6. **–û—Ç–≤–µ—Ç** - –≤–æ–∑–≤—Ä–∞—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–ª–∏–µ–Ω—Ç—É

### –ü–æ–∏—Å–∫ –ø–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—É
1. **–ó–∞–ø—Ä–æ—Å** - GET –∑–∞–ø—Ä–æ—Å —Å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º
2. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞** - FIGI –∏–ª–∏ —Ç–∏–∫–µ—Ä
3. **–ü–æ–∏—Å–∫** - –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
4. **–û—Ç–≤–µ—Ç** - –≤–æ–∑–≤—Ä–∞—Ç –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
1. **–í–∞–ª–∏–¥–∞—Ü–∏—è** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–∞
2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
3. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ** - –≤–æ–∑–≤—Ä–∞—Ç –æ—à–∏–±–∫–∏ –∫–ª–∏–µ–Ω—Ç—É
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –æ—à–∏–±–æ–∫