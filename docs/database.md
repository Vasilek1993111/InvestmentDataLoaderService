# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–°—Ö–µ–º–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `invest`.

## üìä –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

#### `shares` - –ê–∫—Ü–∏–∏
**–ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á:** `figi`
- `figi` (VARCHAR(255), NOT NULL) - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ (Financial Instrument Global Identifier)
- `ticker` (VARCHAR(255)) - –¢–∏–∫–µ—Ä –∞–∫—Ü–∏–∏
- `name` (VARCHAR(255)) - –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏
- `currency` (VARCHAR(255)) - –í–∞–ª—é—Ç–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏
- `exchange` (VARCHAR(255)) - –ë–∏—Ä–∂–∞, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π —Ç–æ—Ä–≥—É–µ—Ç—Å—è –∞–∫—Ü–∏—è
- `sector` (VARCHAR(255)) - –°–µ–∫—Ç–æ—Ä —ç–∫–æ–Ω–æ–º–∏–∫–∏
- `trading_status` (VARCHAR(255)) - –°—Ç–∞—Ç—É—Å —Ç–æ—Ä–≥–æ–≤–ª–∏
- `created_at` (TIMESTAMP WITH TIME ZONE) - –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏ (–º–æ—Å–∫–æ–≤—Å–∫–æ–µ –≤—Ä–µ–º—è)
- `updated_at` (TIMESTAMP WITH TIME ZONE) - –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏ (–º–æ—Å–∫–æ–≤—Å–∫–æ–µ –≤—Ä–µ–º—è)

#### `futures` - –§—å—é—á–µ—Ä—Å—ã
**–ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á:** `figi`
- `figi` (VARCHAR(255), NOT NULL) - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `asset_type` (VARCHAR(255)) - –¢–∏–ø –±–∞–∑–æ–≤–æ–≥–æ –∞–∫—Ç–∏–≤–∞ (TYPE_SECURITY, TYPE_COMMODITY, TYPE_CURRENCY, TYPE_INDEX)
- `basic_asset` (VARCHAR(255)) - –ë–∞–∑–æ–≤—ã–π –∞–∫—Ç–∏–≤ —Ñ—å—é—á–µ—Ä—Å–∞
- `currency` (VARCHAR(255)) - –í–∞–ª—é—Ç–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `exchange` (VARCHAR(255)) - –ë–∏—Ä–∂–∞, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π —Ç–æ—Ä–≥—É–µ—Ç—Å—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
- `ticker` (VARCHAR(255)) - –¢–∏–∫–µ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `created_at` (TIMESTAMP(6), NOT NULL) - –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏
- `updated_at` (TIMESTAMP(6), NOT NULL) - –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏

#### `indicatives` - –ò–Ω–¥–∏–∫–∞—Ç–∏–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
**–ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á:** `figi`
- `figi` (VARCHAR(255), NOT NULL) - FIGI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä)
- `ticker` (VARCHAR(255), NOT NULL) - –¢–∏–∫–µ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `name` (VARCHAR(255), NOT NULL) - –ù–∞–∑–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `currency` (VARCHAR(255), NOT NULL) - –í–∞–ª—é—Ç–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `exchange` (VARCHAR(255), NOT NULL) - –ë–∏—Ä–∂–∞/–ø–ª–æ—â–∞–¥–∫–∞
- `class_code` (VARCHAR(255)) - –ö–æ–¥ –∫–ª–∞—Å—Å–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `uid` (VARCHAR(255)) - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `sell_available_flag` (BOOLEAN, DEFAULT FALSE) - –§–ª–∞–≥ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏
- `buy_available_flag` (BOOLEAN, DEFAULT FALSE) - –§–ª–∞–≥ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –¥–ª—è –ø–æ–∫—É–ø–∫–∏
- `created_at` (TIMESTAMP WITH TIME ZONE) - –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏ (UTC+3)
- `updated_at` (TIMESTAMP WITH TIME ZONE) - –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏ (UTC+3)

### –†—ã–Ω–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

#### `minute_candles` - –ú–∏–Ω—É—Ç–Ω—ã–µ —Å–≤–µ—á–∏
**–ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á:** `(figi, time)`
**–ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü–æ –¥–Ω—è–º (RANGE –ø–æ time)
- `figi` (VARCHAR(255), NOT NULL) - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `time` (TIMESTAMP(6) WITH TIME ZONE, NOT NULL) - –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –º–∏–Ω—É—Ç–Ω–æ–π —Å–≤–µ—á–∏ –≤ –º–æ—Å–∫–æ–≤—Å–∫–æ–π —Ç–∞–π–º–∑–æ–Ω–µ
- `open` (NUMERIC(18,9), NOT NULL) - –¶–µ–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –∑–∞ –º–∏–Ω—É—Ç—É
- `high` (NUMERIC(18,9), NOT NULL) - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –∑–∞ –º–∏–Ω—É—Ç—É
- `low` (NUMERIC(18,9), NOT NULL) - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –∑–∞ –º–∏–Ω—É—Ç—É
- `close` (NUMERIC(18,9), NOT NULL) - –¶–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –∑–∞ –º–∏–Ω—É—Ç—É
- `volume` (BIGINT, NOT NULL) - –û–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤ –∑–∞ –º–∏–Ω—É—Ç—É (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–æ—Ç–æ–≤)
- `is_complete` (BOOLEAN, NOT NULL) - –§–ª–∞–≥ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ—Å—Ç–∏ —Å–≤–µ—á–∏
- `price_change` (NUMERIC(18,9)) - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã (close - open)
- `price_change_percent` (NUMERIC(18,4)) - –ü—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã
- `candle_type` (VARCHAR(20)) - –¢–∏–ø —Å–≤–µ—á–∏: BULLISH, BEARISH, DOJI
- `body_size` (NUMERIC(18,9)) - –†–∞–∑–º–µ—Ä —Ç–µ–ª–∞ —Å–≤–µ—á–∏ (–∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω—ã)
- `upper_shadow` (NUMERIC(18,9)) - –í–µ—Ä—Ö–Ω—è—è —Ç–µ–Ω—å —Å–≤–µ—á–∏
- `lower_shadow` (NUMERIC(18,9)) - –ù–∏–∂–Ω—è—è —Ç–µ–Ω—å —Å–≤–µ—á–∏
- `high_low_range` (NUMERIC(18,9)) - –î–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω (high - low)
- `average_price` (NUMERIC(18,2)) - –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ (high + low + open + close) / 4
- `created_at` (TIMESTAMP(6) WITH TIME ZONE) - –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏
- `updated_at` (TIMESTAMP(6) WITH TIME ZONE) - –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏

#### `daily_candles` - –î–Ω–µ–≤–Ω—ã–µ —Å–≤–µ—á–∏
**–ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á:** `(figi, time)`
**–ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü–æ –º–µ—Å—è—Ü–∞–º (RANGE –ø–æ time)
- `figi` (VARCHAR(255), NOT NULL) - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `time` (TIMESTAMP(6) WITH TIME ZONE, NOT NULL) - –î–∞—Ç–∞ —Ç–æ—Ä–≥–æ–≤ (–Ω–∞—á–∞–ª–æ –¥–Ω—è)
- `open` (NUMERIC(18,9), NOT NULL) - –¶–µ–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –¥–Ω—è
- `high` (NUMERIC(18,9), NOT NULL) - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –¥–Ω—è
- `low` (NUMERIC(18,9), NOT NULL) - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –¥–Ω—è
- `close` (NUMERIC(18,9), NOT NULL) - –¶–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –¥–Ω—è
- `volume` (BIGINT, NOT NULL) - –û–±—â–∏–π –æ–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤ –∑–∞ –¥–µ–Ω—å
- `is_complete` (BOOLEAN, NOT NULL) - –§–ª–∞–≥ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ—Å—Ç–∏ —Å–≤–µ—á–∏
- `price_change` (NUMERIC(18,9)) - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã (close - open)
- `price_change_percent` (NUMERIC(18,4)) - –ü—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã
- `candle_type` (VARCHAR(20)) - –¢–∏–ø —Å–≤–µ—á–∏: BULLISH, BEARISH, DOJI
- `body_size` (NUMERIC(18,9)) - –†–∞–∑–º–µ—Ä —Ç–µ–ª–∞ —Å–≤–µ—á–∏
- `upper_shadow` (NUMERIC(18,9)) - –í–µ—Ä—Ö–Ω—è—è —Ç–µ–Ω—å —Å–≤–µ—á–∏
- `lower_shadow` (NUMERIC(18,9)) - –ù–∏–∂–Ω—è—è —Ç–µ–Ω—å —Å–≤–µ—á–∏
- `high_low_range` (NUMERIC(18,9)) - –î–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω
- `average_price` (NUMERIC(18,2)) - –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞
- `created_at` (TIMESTAMP(6) WITH TIME ZONE) - –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏
- `updated_at` (TIMESTAMP(6) WITH TIME ZONE) - –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏

### –¶–µ–Ω—ã —Å–µ—Å—Å–∏–π

#### `close_prices` - –¶–µ–Ω—ã –∑–∞–∫—Ä—ã—Ç–∏—è –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏
**–ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á:** `(figi, price_date)`
**–ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü–æ –º–µ—Å—è—Ü–∞–º (RANGE –ø–æ price_date)
- `figi` (VARCHAR(255), NOT NULL) - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `price_date` (DATE, NOT NULL) - –î–∞—Ç–∞ —Ç–æ—Ä–≥–æ–≤
- `close_price` (NUMERIC(18,9), NOT NULL) - –¶–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `instrument_type` (VARCHAR(255), NOT NULL) - –¢–∏–ø —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `currency` (VARCHAR(255), NOT NULL) - –í–∞–ª—é—Ç–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π –≤—ã—Ä–∞–∂–µ–Ω–∞ —Ü–µ–Ω–∞
- `exchange` (VARCHAR(255), NOT NULL) - –ë–∏—Ä–∂–∞, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π —Ç–æ—Ä–≥—É–µ—Ç—Å—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
- `created_at` (TIMESTAMP(6) WITH TIME ZONE) - –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏
- `updated_at` (TIMESTAMP(6) WITH TIME ZONE) - –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏

#### `close_prices_evening_session` - –¶–µ–Ω—ã –∑–∞–∫—Ä—ã—Ç–∏—è –≤–µ—á–µ—Ä–Ω–µ–π —Å–µ—Å—Å–∏–∏
**–ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á:** `(price_date, figi)`
- `price_date` (DATE, NOT NULL) - –î–∞—Ç–∞ —Ç–æ—Ä–≥–æ–≤
- `figi` (VARCHAR(255), NOT NULL) - –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `close_price` (DECIMAL(18,9), NOT NULL) - –¶–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –≤–µ—á–µ—Ä–Ω–µ–π —Å–µ—Å—Å–∏–∏
- `instrument_type` (VARCHAR) - –¢–∏–ø –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ (SHARES, FUTURES)
- `currency` (VARCHAR) - –í–∞–ª—é—Ç–∞ (RUB)
- `exchange` (VARCHAR) - –ë–∏—Ä–∂–∞ (MOEX)
- `created_at` (TIMESTAMP) - –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏

#### `open_prices` - –¶–µ–Ω—ã –æ—Ç–∫—Ä—ã—Ç–∏—è —É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Å—Å–∏–∏
**–ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á:** `(figi, price_date)`
**–ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü–æ –º–µ—Å—è—Ü–∞–º (RANGE –ø–æ price_date)
- `figi` (VARCHAR(255), NOT NULL) - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `price_date` (DATE, NOT NULL) - –î–∞—Ç–∞ —Ç–æ—Ä–≥–æ–≤
- `open_price` (NUMERIC(18,9), NOT NULL) - –¶–µ–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `instrument_type` (VARCHAR(255), NOT NULL) - –¢–∏–ø —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `currency` (VARCHAR(255), NOT NULL) - –í–∞–ª—é—Ç–∞, –≤ –∫–æ—Ç–æ—Ä–æ–π –≤—ã—Ä–∞–∂–µ–Ω–∞ —Ü–µ–Ω–∞
- `exchange` (VARCHAR(255), NOT NULL) - –ë–∏—Ä–∂–∞, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π —Ç–æ—Ä–≥—É–µ—Ç—Å—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
- `created_at` (TIMESTAMP(6) WITH TIME ZONE) - –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏
- `updated_at` (TIMESTAMP(6) WITH TIME ZONE) - –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏

### –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–¥–µ–ª–∫–∏

#### `last_prices` - –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ü–µ–Ω—ã
**–ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á:** `(figi, time)`
**–ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü–æ –¥–Ω—è–º (RANGE –ø–æ time)
- `figi` (VARCHAR(255), NOT NULL) - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `time` (TIMESTAMP(6) WITH TIME ZONE, NOT NULL) - –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–¥–µ–ª–∫–∏
- `price` (NUMERIC(18,9), NOT NULL) - –¶–µ–Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–¥–µ–ª–∫–∏
- `currency` (VARCHAR(255), NOT NULL) - –í–∞–ª—é—Ç–∞ —Å–¥–µ–ª–∫–∏
- `exchange` (VARCHAR(255), NOT NULL) - –ë–∏—Ä–∂–∞
- `created_at` (TIMESTAMP(6) WITH TIME ZONE) - –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏
- `updated_at` (TIMESTAMP(6) WITH TIME ZONE) - –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏

### –°–µ—Ä–≤–∏—Å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

#### `system_logs` - –°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏
**–ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á:** `id`
- `id` (BIGSERIAL) - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–ø–∏—Å–∏
- `task_id` (VARCHAR(255), NOT NULL) - ID –∑–∞–¥–∞—á–∏
- `endpoint` (VARCHAR(255), NOT NULL) - –ù–∞–∑–≤–∞–Ω–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞
- `method` (VARCHAR(255), NOT NULL) - HTTP –º–µ—Ç–æ–¥
- `status` (VARCHAR(255), NOT NULL) - –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- `message` (TEXT, NOT NULL) - –¢–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ä–∞–±–æ—Ç–µ
- `start_time` (TIMESTAMP WITH TIME ZONE, NOT NULL) - –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞
- `end_time` (TIMESTAMP WITH TIME ZONE) - –í—Ä–µ–º—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
- `duration_ms` (BIGINT) - –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
- `created_at` (TIMESTAMP WITH TIME ZONE) - –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏

#### `index_session_times` - –í—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è —Å–µ—Å—Å–∏–π –∏–Ω–¥–µ–∫—Å–æ–≤
**–ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á:** `figi`
- `figi` (VARCHAR(50), NOT NULL) - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ (FIGI)
- `ticker` (VARCHAR(20), NOT NULL) - –¢–∏–∫–µ—Ä –∏–Ω–¥–µ–∫—Å–∞
- `name` (VARCHAR(255), NOT NULL) - –ù–∞–∑–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞
- `session_close_time` (TIME, NOT NULL) - –í—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è —Ç–æ—Ä–≥–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ –ø–æ –ú–æ—Å–∫–æ–≤—Å–∫–æ–º—É –≤—Ä–µ–º–µ–Ω–∏
- `description` (TEXT) - –û–ø–∏—Å–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞
- `is_active` (BOOLEAN, DEFAULT TRUE) - –ê–∫—Ç–∏–≤–Ω–∞ –ª–∏ –∑–∞–ø–∏—Å—å
- `created_at` (TIMESTAMP WITH TIME ZONE) - –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏
- `updated_at` (TIMESTAMP WITH TIME ZONE) - –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏

## üìà –ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è

### `daily_volume_aggregation` - –û–±—â–µ–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ figi –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è
**–ò—Å—Ç–æ—á–Ω–∏–∫:** `minute_candles` (—Ç–∞–π–º–∑–æ–Ω–∞ `Europe/Moscow`)

**–ü–æ–ª—è:**
- `figi` (VARCHAR) - –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `instrument_type` (TEXT) - –¢–∏–ø –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ (share, future, unknown)
- `total_volume` (BIGINT) - –û–±—â–∏–π –æ–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤ –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è
- `total_candles` (BIGINT) - –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è
- `avg_volume_per_candle` (NUMERIC) - –°—Ä–µ–¥–Ω–∏–π –æ–±—ä–µ–º –Ω–∞ –æ–¥–Ω—É —Å–≤–µ—á—É, –æ–∫—Ä—É–≥–ª–µ–Ω–æ –¥–æ 2 –∑–Ω–∞–∫–æ–≤
- `morning_session_volume` (BIGINT) - –û–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤ –≤ —É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Å—Å–∏–∏ (06:59-09:59 –ú–°–ö)
- `morning_session_candles` (BIGINT) - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –≤ —É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Å—Å–∏–∏
- `morning_avg_volume_per_candle` (NUMERIC) - –°—Ä–µ–¥–Ω–∏–π –æ–±—ä–µ–º –Ω–∞ —Å–≤–µ—á—É –≤ —É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Å—Å–∏–∏
- `main_session_volume` (BIGINT) - –û–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏ (10:00-18:45 –ú–°–ö)
- `main_session_candles` (BIGINT) - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏
- `main_avg_volume_per_candle` (NUMERIC) - –°—Ä–µ–¥–Ω–∏–π –æ–±—ä–µ–º –Ω–∞ —Å–≤–µ—á—É –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏
- `evening_session_volume` (BIGINT) - –û–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤ –≤ –≤–µ—á–µ—Ä–Ω–µ–π —Å–µ—Å—Å–∏–∏ (19:05-23:50 –ú–°–ö)
- `evening_session_candles` (BIGINT) - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –≤ –≤–µ—á–µ—Ä–Ω–µ–π —Å–µ—Å—Å–∏–∏
- `evening_avg_volume_per_candle` (NUMERIC) - –°—Ä–µ–¥–Ω–∏–π –æ–±—ä–µ–º –Ω–∞ —Å–≤–µ—á—É –≤ –≤–µ—á–µ—Ä–Ω–µ–π —Å–µ—Å—Å–∏–∏
- `weekend_exchange_session_volume` (BIGINT) - –û–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤ –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏ (–±–∏—Ä–∂–µ–≤–∞—è —Å–µ—Å—Å–∏—è)
- `weekend_exchange_session_candles` (BIGINT) - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏ (–±–∏—Ä–∂–µ–≤–∞—è —Å–µ—Å—Å–∏—è)
- `weekend_exchange_avg_volume_per_candle` (NUMERIC) - –°—Ä–µ–¥–Ω–∏–π –æ–±—ä–µ–º –Ω–∞ —Å–≤–µ—á—É –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏ (–±–∏—Ä–∂–µ–≤–∞—è —Å–µ—Å—Å–∏—è)
- `weekend_otc_session_volume` (BIGINT) - –û–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤ –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏ (OTC —Å–µ—Å—Å–∏—è)
- `weekend_otc_session_candles` (BIGINT) - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏ (OTC —Å–µ—Å—Å–∏—è)
- `weekend_otc_avg_volume_per_candle` (NUMERIC) - –°—Ä–µ–¥–Ω–∏–π –æ–±—ä–µ–º –Ω–∞ —Å–≤–µ—á—É –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏ (OTC —Å–µ—Å—Å–∏—è)
- `first_candle_time` (TIMESTAMP) - –í—Ä–µ–º—è –ø–µ—Ä–≤–æ–π —Å–≤–µ—á–∏
- `last_candle_time` (TIMESTAMP) - –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–≤–µ—á–∏
- `last_updated` (TIMESTAMP) - –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏

### `today_volume_aggregation` - –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞ —Ç–µ–∫—É—â–∏–π –¥–µ–Ω—å
**–ò—Å—Ç–æ—á–Ω–∏–∫:** `minute_candles` (—Ç–∞–π–º–∑–æ–Ω–∞ `Europe/Moscow`)

**–ü–æ–ª—è:**
- `figi` (VARCHAR) - –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `instrument_type` (TEXT) - –¢–∏–ø –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ (share, future, unknown)
- `trade_date` (DATE) - –î–∞—Ç–∞ —Ç–æ—Ä–≥–æ–≤ (—Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞)
- `total_volume` (BIGINT) - –û–±—â–∏–π –æ–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤ –∑–∞ –¥–µ–Ω—å
- `total_candles` (BIGINT) - –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –∑–∞ –¥–µ–Ω—å
- `avg_volume_per_candle` (NUMERIC) - –°—Ä–µ–¥–Ω–∏–π –æ–±—ä–µ–º –Ω–∞ –æ–¥–Ω—É —Å–≤–µ—á—É –∑–∞ –¥–µ–Ω—å
- `morning_session_volume` (BIGINT) - –û–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤ –≤ —É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Å—Å–∏–∏
- `morning_session_candles` (BIGINT) - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –≤ —É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Å—Å–∏–∏
- `morning_avg_volume_per_candle` (NUMERIC) - –°—Ä–µ–¥–Ω–∏–π –æ–±—ä–µ–º –Ω–∞ —Å–≤–µ—á—É –≤ —É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Å—Å–∏–∏
- `main_session_volume` (BIGINT) - –û–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏
- `main_session_candles` (BIGINT) - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏
- `main_avg_volume_per_candle` (NUMERIC) - –°—Ä–µ–¥–Ω–∏–π –æ–±—ä–µ–º –Ω–∞ —Å–≤–µ—á—É –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏
- `evening_session_volume` (BIGINT) - –û–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤ –≤ –≤–µ—á–µ—Ä–Ω–µ–π —Å–µ—Å—Å–∏–∏
- `evening_session_candles` (BIGINT) - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –≤ –≤–µ—á–µ—Ä–Ω–µ–π —Å–µ—Å—Å–∏–∏
- `evening_avg_volume_per_candle` (NUMERIC) - –°—Ä–µ–¥–Ω–∏–π –æ–±—ä–µ–º –Ω–∞ —Å–≤–µ—á—É –≤ –≤–µ—á–µ—Ä–Ω–µ–π —Å–µ—Å—Å–∏–∏
- `weekend_exchange_session_volume` (BIGINT) - –û–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤ –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏ (–±–∏—Ä–∂–µ–≤–∞—è —Å–µ—Å—Å–∏—è)
- `weekend_exchange_session_candles` (BIGINT) - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏ (–±–∏—Ä–∂–µ–≤–∞—è —Å–µ—Å—Å–∏—è)
- `weekend_exchange_avg_volume_per_candle` (NUMERIC) - –°—Ä–µ–¥–Ω–∏–π –æ–±—ä–µ–º –Ω–∞ —Å–≤–µ—á—É –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏ (–±–∏—Ä–∂–µ–≤–∞—è —Å–µ—Å—Å–∏—è)
- `weekend_otc_session_volume` (BIGINT) - –û–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤ –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏ (OTC —Å–µ—Å—Å–∏—è)
- `weekend_otc_session_candles` (BIGINT) - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏ (OTC —Å–µ—Å—Å–∏—è)
- `weekend_otc_avg_volume_per_candle` (NUMERIC) - –°—Ä–µ–¥–Ω–∏–π –æ–±—ä–µ–º –Ω–∞ —Å–≤–µ—á—É –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏ (OTC —Å–µ—Å—Å–∏—è)
- `first_candle_time` (TIMESTAMP) - –í—Ä–µ–º—è –ø–µ—Ä–≤–æ–π —Å–≤–µ—á–∏ –∑–∞ –¥–µ–Ω—å
- `last_candle_time` (TIMESTAMP) - –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–≤–µ—á–∏ –∑–∞ –¥–µ–Ω—å
- `last_updated` (TIMESTAMP) - –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏

## üîç –û–±—ã—á–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è

### `today_volume_view` - –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ–±—ä–µ–º–æ–≤ –∑–∞ —Å–µ–≥–æ–¥–Ω—è
**–ò—Å—Ç–æ—á–Ω–∏–∫:** `minute_candles` + `shares` + `futures`

**–ü–æ–ª—è:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã `today_volume_aggregation`

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –í–∫–ª—é—á–∞–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ JOIN —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –∑–∞ —Ç–µ–∫—É—â–∏–π –¥–µ–Ω—å

## ‚öôÔ∏è –§—É–Ω–∫—Ü–∏–∏ –∏ —Ç—Ä–∏–≥–≥–µ—Ä—ã (PL/pgSQL)

### –§—É–Ω–∫—Ü–∏–∏ –≤—Å—Ç–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö

#### `bulk_insert_last_prices(p_figi, p_time, p_price, p_currency, p_exchange)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –¥–Ω–µ–≤–Ω—ã—Ö –ø–∞—Ä—Ç–∏—Ü–∏–π
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `p_figi` (VARCHAR) - FIGI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `p_time` (TIMESTAMP) - –í—Ä–µ–º—è —Å–¥–µ–ª–∫–∏
- `p_price` (NUMERIC) - –¶–µ–Ω–∞ —Å–¥–µ–ª–∫–∏
- `p_currency` (VARCHAR) - –í–∞–ª—é—Ç–∞
- `p_exchange` (VARCHAR) - –ë–∏—Ä–∂–∞

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –¥–Ω–µ–≤–Ω—ã–µ –ø–∞—Ä—Ç–∏—Ü–∏–∏ –¥–ª—è `last_prices`
- –í—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Å—Ç–∞–≤–∫—É —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `ON CONFLICT (figi, time) DO NOTHING`

### –§—É–Ω–∫—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π

#### `update_today_volume_aggregation()`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è `today_volume_aggregation`
**–í—ã–ø–æ–ª–Ω—è–µ—Ç:** `REFRESH MATERIALIZED VIEW invest.today_volume_aggregation`

#### `update_daily_volume_aggregation()`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è `daily_volume_aggregation`
**–í—ã–ø–æ–ª–Ω—è–µ—Ç:** `REFRESH MATERIALIZED VIEW invest.daily_volume_aggregation`

### –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### `get_session_analytics(figi, start_date, end_date)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –ø–æ —Å–µ—Å—Å–∏—è–º –∑–∞ –ø–µ—Ä–∏–æ–¥
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `figi` (VARCHAR) - FIGI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `start_date` (DATE) - –ù–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞
- `end_date` (DATE) - –ö–æ–Ω–µ—á–Ω–∞—è –¥–∞—Ç–∞

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** –¢–∞–±–ª–∏—Ü—É —Å –ø–æ–ª—è–º–∏:
- `figi, trade_date, total_volume, total_candles, avg_volume_per_candle`
- `morning_session_volume, morning_session_candles, morning_avg_volume_per_candle`
- `main_session_volume, main_session_candles, main_avg_volume_per_candle`
- `evening_session_volume, evening_session_candles, evening_avg_volume_per_candle`
- `weekend_exchange_session_volume, weekend_exchange_session_candles, weekend_exchange_avg_volume_per_candle`
- `weekend_otc_session_volume, weekend_otc_session_candles, weekend_otc_avg_volume_per_candle`

#### `get_today_session_analytics(figi)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –ø–æ —Å–µ—Å—Å–∏—è–º –∑–∞ —Å–µ–≥–æ–¥–Ω—è
**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `figi` (VARCHAR) - FIGI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ `get_session_analytics` –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –¥–Ω—è

### –¢—Ä–∏–≥–≥–µ—Ä—ã

#### `calculate_minute_candle_statistics()`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–ª—è –º–∏–Ω—É—Ç–Ω—ã—Ö —Å–≤–µ—á–µ–π
**–°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:** BEFORE INSERT OR UPDATE –Ω–∞ `minute_candles`

**–í—ã—á–∏—Å–ª—è–µ—Ç:**
- `price_change` = close - open
- `price_change_percent` = (price_change / open) * 100
- `candle_type` = BULLISH/BEARISH/DOJI
- `body_size` = ABS(price_change)
- `upper_shadow` = high - GREATEST(open, close)
- `lower_shadow` = LEAST(open, close) - low
- `high_low_range` = high - low
- `average_price` = (high + low + close) / 3

#### `calculate_daily_candle_statistics()`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–ª—è –¥–Ω–µ–≤–Ω—ã—Ö —Å–≤–µ—á–µ–π
**–°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:** BEFORE INSERT OR UPDATE –Ω–∞ `daily_candles`

**–í—ã—á–∏—Å–ª—è–µ—Ç:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ `calculate_minute_candle_statistics`

#### `calculate_duration_ms()`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
**–°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:** BEFORE INSERT OR UPDATE –Ω–∞ `system_logs`

**–í—ã—á–∏—Å–ª—è–µ—Ç:**
- `duration_ms` = EXTRACT(EPOCH FROM (end_time - start_time)) * 1000

## üîß –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ú–∏–Ω—É—Ç–Ω—ã–µ —Å–≤–µ—á–∏ (`minute_candles`)
**–¢–∏–ø –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:** RANGE –ø–æ `time`
**–ü–∞—Ä—Ç–∏—Ü–∏–∏:** –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ (–ø–æ –¥–Ω—è–º)
**–ü—Ä–∏–º–µ—Ä—ã –ø–∞—Ä—Ç–∏—Ü–∏–π:**
- `minute_candles_2024_06_01` - –¥–∞–Ω–Ω—ã–µ –∑–∞ 1 –∏—é–Ω—è 2024
- `minute_candles_2024_06_02` - –¥–∞–Ω–Ω—ã–µ –∑–∞ 2 –∏—é–Ω—è 2024
- –ò —Ç.–¥.

### –î–Ω–µ–≤–Ω—ã–µ —Å–≤–µ—á–∏ (`daily_candles`)
**–¢–∏–ø –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:** RANGE –ø–æ `time`
**–ü–∞—Ä—Ç–∏—Ü–∏–∏:** –ï–∂–µ–º–µ—Å—è—á–Ω—ã–µ (–ø–æ –º–µ—Å—è—Ü–∞–º)
**–ü—Ä–∏–º–µ—Ä—ã –ø–∞—Ä—Ç–∏—Ü–∏–π:**
- `daily_candles_2024_01` - –¥–∞–Ω–Ω—ã–µ –∑–∞ —è–Ω–≤–∞—Ä—å 2024
- `daily_candles_2024_02` - –¥–∞–Ω–Ω—ã–µ –∑–∞ —Ñ–µ–≤—Ä–∞–ª—å 2024
- –ò —Ç.–¥.

### –¶–µ–Ω—ã –∑–∞–∫—Ä—ã—Ç–∏—è (`close_prices`)
**–¢–∏–ø –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:** RANGE –ø–æ `price_date`
**–ü–∞—Ä—Ç–∏—Ü–∏–∏:** –ï–∂–µ–º–µ—Å—è—á–Ω—ã–µ (–ø–æ –º–µ—Å—è—Ü–∞–º)
**–ü—Ä–∏–º–µ—Ä—ã –ø–∞—Ä—Ç–∏—Ü–∏–π:**
- `close_prices_2024_01` - –¥–∞–Ω–Ω—ã–µ –∑–∞ —è–Ω–≤–∞—Ä—å 2024
- `close_prices_2024_02` - –¥–∞–Ω–Ω—ã–µ –∑–∞ —Ñ–µ–≤—Ä–∞–ª—å 2024
- –ò —Ç.–¥.

### –¶–µ–Ω—ã –æ—Ç–∫—Ä—ã—Ç–∏—è (`open_prices`)
**–¢–∏–ø –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:** RANGE –ø–æ `price_date`
**–ü–∞—Ä—Ç–∏—Ü–∏–∏:** –ï–∂–µ–º–µ—Å—è—á–Ω—ã–µ (–ø–æ –º–µ—Å—è—Ü–∞–º)

### –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ü–µ–Ω—ã (`last_prices`)
**–¢–∏–ø –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:** RANGE –ø–æ `time`
**–ü–∞—Ä—Ç–∏—Ü–∏–∏:** –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ (–ø–æ –¥–Ω—è–º)
**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ:** –ß–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é `bulk_insert_last_prices`

## üìä –ò–Ω–¥–µ–∫—Å—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã
- `minute_candles(figi, time)` - PK
- `daily_candles(figi, time)` - PK
- `close_prices(figi, price_date)` - PK
- `open_prices(figi, price_date)` - PK
- `last_prices(figi, time)` - PK
- `shares(figi)` - PK
- `futures(figi)` - PK
- `indicatives(figi)` - PK

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã
- `idx_minute_candles_time` - –ø–æ –≤—Ä–µ–º–µ–Ω–∏
- `idx_minute_candles_figi_time` - –ø–æ figi –∏ –≤—Ä–µ–º–µ–Ω–∏
- `idx_close_prices_date` - –ø–æ –¥–∞—Ç–µ
- `idx_close_prices_figi_date` - –ø–æ figi –∏ –¥–∞—Ç–µ
- `idx_system_logs_task_id` - –ø–æ task_id
- `idx_system_logs_endpoint` - –ø–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç—É
- `idx_system_logs_status` - –ø–æ —Å—Ç–∞—Ç—É—Å—É

### –ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
- `daily_volume_aggregation(figi)` - UNIQUE
- `today_volume_aggregation(figi)` - UNIQUE

## üîê –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

### –†–æ–ª–∏
- **postgres** - –≤–ª–∞–¥–µ–ª–µ—Ü —Å—Ö–µ–º—ã –∏ —Ç–∞–±–ª–∏—Ü
- **admin** - –ø–æ–ª–Ω—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã
- **tester** - –ø—Ä–∞–≤–∞ —Ç–æ–ª—å–∫–æ –Ω–∞ —á—Ç–µ–Ω–∏–µ

### –ü—Ä–∞–≤–∞ –¥–ª—è admin
- `SELECT, INSERT, UPDATE, DELETE, REFERENCES, TRIGGER, TRUNCATE` –Ω–∞ –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã
- `EXECUTE` –Ω–∞ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏
- `USAGE` –Ω–∞ –≤—Å–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ü—Ä–∞–≤–∞ –¥–ª—è tester
- `SELECT` –Ω–∞ –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã
- `UPDATE` –Ω–∞ `system_logs`
- `USAGE` –Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üïê –¢–∞–π–º–∑–æ–Ω—ã

**–û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–π–º–∑–æ–Ω–∞:** `Europe/Moscow` (UTC+3)

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–∞–π–º–∑–æ–Ω
- –í—Å–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ UTC
- –ü—Ä–∏ –≤—ã–±–æ—Ä–∫–µ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ –º–æ—Å–∫–æ–≤—Å–∫–æ–µ –≤—Ä–µ–º—è
- –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ –º–æ—Å–∫–æ–≤—Å–∫–æ–º—É –≤—Ä–µ–º–µ–Ω–∏
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ —Å–µ—Å—Å–∏—è–º —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ –º–æ—Å–∫–æ–≤—Å–∫–æ–º –≤—Ä–µ–º–µ–Ω–∏

### –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã —Å–µ—Å—Å–∏–π (–ú–°–ö)
- **–£—Ç—Ä–µ–Ω–Ω—è—è —Å–µ—Å—Å–∏—è:** 06:59-09:59
- **–û—Å–Ω–æ–≤–Ω–∞—è —Å–µ—Å—Å–∏—è:** 10:00-18:45
- **–í–µ—á–µ—Ä–Ω—è—è —Å–µ—Å—Å–∏—è:** 19:05-23:50
- **–í—ã—Ö–æ–¥–Ω—ã–µ –¥–Ω–∏:** –°—É–±–±–æ—Ç–∞ –∏ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ** –¥–ª—è `minute_candles` –∏ `last_prices`
- **–ï–∂–µ–º–µ—Å—è—á–Ω–æ–µ** –¥–ª—è `daily_candles`, `close_prices`, `open_prices`
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ** –ø–∞—Ä—Ç–∏—Ü–∏–π —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏–∏

### –ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–°–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã** –ø–æ –æ—Å–Ω–æ–≤–Ω—ã–º –ø–æ–ª—è–º –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ü–æ–∫—Ä—ã–≤–∞—é—â–∏–µ –∏–Ω–¥–µ–∫—Å—ã** –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ü–∞—Ä—Ç–∏—Ü–∏–∞–ª—å–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã** –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
- **–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –≤—ã—á–∏—Å–ª–µ–Ω–Ω–∞—è** –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏–∏
- **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã** –¥–ª—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏

## üîÑ –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

### –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `today_volume_aggregation`
- –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–∞—Ä—Ç–∏—Ü–∏–π
- –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤

### –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `daily_volume_aggregation`
- –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

### –ï–∂–µ–º–µ—Å—è—á–Ω—ã–µ –∑–∞–¥–∞—á–∏
- –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤
- –ê–Ω–∞–ª–∏–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
