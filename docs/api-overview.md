# API Overview

## –û–±–∑–æ—Ä API

Investment Data Loader Service –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç RESTful API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏. –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç JSON –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ HTTP —Å—Ç–∞—Ç—É—Å-–∫–æ–¥—ã.

**–ë–∞–∑–æ–≤—ã–π URL**: `http://localhost:8083/api` (PROD) / `http://localhost:8087/api` (TEST)

## üîß –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# Tinkoff API —Ç–æ–∫–µ–Ω
T_INVEST_TEST_TOKEN=your_test_token_here

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
SPRING_DATASOURCE_PASSWORD=your_password
```

### –ó–∞–ø—É—Å–∫
```bash
# –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
export $(cat .env | xargs)

# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
mvn spring-boot:run
```

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ**: [SETUP.md](../SETUP.md) | [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](../QUICK_START.md)

## üìä –û—Å–Ω–æ–≤–Ω—ã–µ –≥—Ä—É–ø–ø—ã API

### 1. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (`/api/instruments`)
–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ (–∞–∫—Ü–∏–∏, —Ñ—å—é—á–µ—Ä—Å—ã, –∏–Ω–¥–∏–∫–∞—Ç–∏–≤—ã).

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/instruments/shares` | –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∞–∫—Ü–∏–π |
| POST | `/instruments/shares` | –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–∫—Ü–∏–π |
| GET | `/instruments/futures` | –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ñ—å—é—á–µ—Ä—Å–æ–≤ |
| POST | `/instruments/futures` | –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ—å—é—á–µ—Ä—Å–æ–≤ |
| GET | `/instruments/indicatives` | –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–∏–≤–æ–≤ |
| POST | `/instruments/indicatives` | –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–∏–≤–æ–≤ |
| GET | `/instruments/count` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º |

### 2. –°–≤–µ—á–∏ (`/api/candles`)
–†–∞–±–æ—Ç–∞ —Å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ —Å–≤–µ—á–∞–º–∏ (–º–∏–Ω—É—Ç–Ω—ã–µ –∏ –¥–Ω–µ–≤–Ω—ã–µ).

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| POST | `/candles/minute` | –ó–∞–≥—Ä—É–∑–∫–∞ –º–∏–Ω—É—Ç–Ω—ã—Ö —Å–≤–µ—á–µ–π |
| GET | `/candles/minute` | –ü–æ–ª—É—á–µ–Ω–∏–µ –º–∏–Ω—É—Ç–Ω—ã—Ö —Å–≤–µ—á–µ–π |
| POST | `/candles/daily` | –ó–∞–≥—Ä—É–∑–∫–∞ –¥–Ω–µ–≤–Ω—ã—Ö —Å–≤–µ—á–µ–π |
| GET | `/candles/daily` | –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–Ω–µ–≤–Ω—ã—Ö —Å–≤–µ—á–µ–π |
| GET | `/candles/instrument` | –°–≤–µ—á–∏ –ø–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É |

### 3. –¢–æ—Ä–≥–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (`/api/trading`)
–¢–æ—Ä–≥–æ–≤—ã–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è, —Å—Ç–∞—Ç—É—Å—ã –∏ —Å—á–µ—Ç–∞.

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/trading/accounts` | –¢–æ—Ä–≥–æ–≤—ã–µ —Å—á–µ—Ç–∞ |
| GET | `/trading/schedules` | –¢–æ—Ä–≥–æ–≤—ã–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è |
| GET | `/trading/statuses` | –°—Ç–∞—Ç—É—Å—ã —Ç–æ—Ä–≥–æ–≤–ª–∏ |
| GET | `/trading/trading-days` | –¢–æ—Ä–≥–æ–≤—ã–µ –¥–Ω–∏ |
| GET | `/trading/stats` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–æ—Ä–≥–æ–≤ |

### 4. –¶–µ–Ω—ã —Å–µ—Å—Å–∏–π (`/api/sessions`)
–¶–µ–Ω—ã –æ—Ç–∫—Ä—ã—Ç–∏—è –∏ –∑–∞–∫—Ä—ã—Ç–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–µ—Å—Å–∏–π.

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/sessions/morning` | –¶–µ–Ω—ã —É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Å—Å–∏–∏ |
| POST | `/sessions/morning` | –ó–∞–≥—Ä—É–∑–∫–∞ —Ü–µ–Ω —É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Å—Å–∏–∏ |
| GET | `/sessions/main` | –¶–µ–Ω—ã –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏ |
| POST | `/sessions/main` | –ó–∞–≥—Ä—É–∑–∫–∞ —Ü–µ–Ω –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏ |
| GET | `/sessions/evening` | –¶–µ–Ω—ã –≤–µ—á–µ—Ä–Ω–µ–π —Å–µ—Å—Å–∏–∏ |

### 5. –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–¥–µ–ª–∫–∏ (`/api/last-trades`)
–û–±–µ–∑–ª–∏—á–µ–Ω–Ω—ã–µ —Å–¥–µ–ª–∫–∏ –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ü–µ–Ω—ã.

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/last-trades` | –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–¥–µ–ª–∫–∏ |
| POST | `/last-trades` | –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–¥–µ–ª–æ–∫ |
| GET | `/last-trades/shares` | –°–¥–µ–ª–∫–∏ –ø–æ –∞–∫—Ü–∏—è–º |
| GET | `/last-trades/futures` | –°–¥–µ–ª–∫–∏ –ø–æ —Ñ—å—é—á–µ—Ä—Å–∞–º |

### 6. –ö—ç—à (`/api/cache`)
–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–µ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| POST | `/cache/warmup` | –ü—Ä–æ–≥—Ä–µ–≤ –∫—ç—à–∞ |
| GET | `/cache/info` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫—ç—à–µ |
| DELETE | `/cache/clear` | –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ |
| GET | `/cache/stats` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞ |

### 7. –ê–≥—Ä–µ–≥–∞—Ü–∏—è (`/api/aggregation`)
–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏—è –æ–±—ä–µ–º–æ–≤.

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/aggregation/volume` | –ê–≥—Ä–µ–≥–∞—Ü–∏—è –æ–±—ä–µ–º–æ–≤ |
| POST | `/aggregation/refresh` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ |
| GET | `/aggregation/shares` | –ê–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ –∞–∫—Ü–∏—è–º |
| GET | `/aggregation/futures` | –ê–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ —Ñ—å—é—á–µ—Ä—Å–∞–º |

### 8. –°–∏—Å—Ç–µ–º–∞ (`/api/system`)
–°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥.

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| GET | `/system/health` | –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã |
| GET | `/system/info` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ |
| GET | `/system/logs` | –°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏ |
| GET | `/system/status` | –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã |

## üîç –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

#### GET /api/instruments/shares
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∞–∫—Ü–∏–π —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `source` (string, optional) - –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö: "api" –∏–ª–∏ "database" (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "api")
- `status` (string, optional) - —Å—Ç–∞—Ç—É—Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `exchange` (string, optional) - –±–∏—Ä–∂–∞
- `currency` (string, optional) - –≤–∞–ª—é—Ç–∞
- `ticker` (string, optional) - —Ç–∏–∫–µ—Ä
- `figi` (string, optional) - FIGI

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```bash
curl "http://localhost:8083/api/instruments/shares?exchange=MOEX&currency=RUB"
```

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "figi": "BBG004730N88",
    "ticker": "SBER",
    "name": "–°–±–µ—Ä–±–∞–Ω–∫",
    "currency": "RUB",
    "exchange": "MOEX",
    "sector": "Financial Services",
    "tradingStatus": "SECURITY_TRADING_STATUS_NORMAL_TRADING"
  }
]
```

#### POST /api/instruments/shares
–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–∫—Ü–∏–π –≤ –ë–î —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "status": "INSTRUMENT_STATUS_ACTIVE",
  "exchange": "MOEX",
  "currency": "RUB",
  "ticker": "SBER"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "message": "–£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ 5 –Ω–æ–≤—ã—Ö –∞–∫—Ü–∏–π –∏–∑ 10 –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö.",
  "totalRequested": 10,
  "newItemsSaved": 5,
  "existingItemsSkipped": 5,
  "invalidItemsFiltered": 0,
  "missingFromApi": 0,
  "savedItems": [...]
}
```

### –°–≤–µ—á–∏

#### POST /api/candles/minute
–ó–∞–≥—Ä—É–∑–∫–∞ –º–∏–Ω—É—Ç–Ω—ã—Ö —Å–≤–µ—á–µ–π –∑–∞ —Å–µ–≥–æ–¥–Ω—è.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "instruments": ["BBG004730N88", "BBG004730ZJ9"],
  "assetType": ["share", "future"]
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "message": "–ó–∞–≥—Ä—É–∑–∫–∞ –º–∏–Ω—É—Ç–Ω—ã—Ö —Å–≤–µ—á–µ–π –∑–∞ —Å–µ–≥–æ–¥–Ω—è –∑–∞–ø—É—â–µ–Ω–∞",
  "taskId": "550e8400-e29b-41d4-a716-446655440000",
  "status": "STARTED",
  "startTime": "2024-01-15T10:30:00Z"
}
```

#### GET /api/candles/minute
–ü–æ–ª—É—á–µ–Ω–∏–µ –º–∏–Ω—É—Ç–Ω—ã—Ö —Å–≤–µ—á–µ–π.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `figi` (string) - FIGI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
- `from` (string) - –Ω–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞ (ISO 8601)
- `to` (string) - –∫–æ–Ω–µ—á–Ω–∞—è –¥–∞—Ç–∞ (ISO 8601)

### –¢–æ—Ä–≥–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

#### GET /api/trading/accounts
–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å—á–µ—Ç–æ–≤.

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "id": "2000123456",
    "name": "–ë—Ä–æ–∫–µ—Ä—Å–∫–∏–π —Å—á–µ—Ç",
    "type": "ACCOUNT_TYPE_TINKOFF"
  }
]
```

#### GET /api/trading/schedules
–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `exchange` (string, optional) - –±–∏—Ä–∂–∞
- `from` (string, optional) - –Ω–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞
- `to` (string, optional) - –∫–æ–Ω–µ—á–Ω–∞—è –¥–∞—Ç–∞

### –ö—ç—à

#### POST /api/cache/warmup
–ü—Ä–æ–≥—Ä–µ–≤ –∫—ç—à–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "message": "–ö—ç—à —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–≥—Ä–µ—Ç",
  "timestamp": "2024-01-15T10:30:00Z"
}
```

#### GET /api/cache/info
–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫—ç—à–µ.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `cacheName` (string, optional) - –∏–º—è –∫—ç—à–∞
- `limit` (number, optional) - –ª–∏–º–∏—Ç –∑–∞–ø–∏—Å–µ–π

### –°–∏—Å—Ç–µ–º–∞

#### GET /api/system/health
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã.

**–û—Ç–≤–µ—Ç:**
```json
{
  "status": "UP",
  "components": {
    "database": "UP",
    "tinkoffApi": "UP"
  },
  "timestamp": "2024-01-15T10:30:00Z"
}
```

## üìù –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤
- **–£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å**: HTTP 200 —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ JSON
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è**: HTTP 202 —Å taskId –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
- **–û—à–∏–±–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞**: HTTP 400/404 —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –æ—à–∏–±–∫–∏
- **–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞**: HTTP 500 —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π

### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
–ú–Ω–æ–≥–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç `taskId`:
```json
{
  "success": true,
  "taskId": "550e8400-e29b-41d4-a716-446655440000",
  "status": "STARTED",
  "message": "–û–ø–µ—Ä–∞—Ü–∏—è –∑–∞–ø—É—â–µ–Ω–∞"
}
```

### –ü–∞–≥–∏–Ω–∞—Ü–∏—è
–î–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è:
```json
{
  "data": [...],
  "page": 0,
  "size": 20,
  "totalElements": 100,
  "totalPages": 5
}
```

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –æ—Å–Ω–æ–≤–Ω—ã–º –ø–æ–ª—è–º:
- –°—Ç—Ä–æ–∫–æ–≤—ã–µ –ø–æ–ª—è: —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ (case-insensitive)
- –ß–∏—Å–ª–æ–≤—ã–µ –ø–æ–ª—è: —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
- –î–∞—Ç—ã: –¥–∏–∞–ø–∞–∑–æ–Ω –∏–ª–∏ —Ç–æ—á–Ω–∞—è –¥–∞—Ç–∞
- FIGI: —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ

### –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ —Ç–∏–∫–µ—Ä—É (–¥–ª—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤) –∏–ª–∏ –ø–æ –¥–∞—Ç–µ (–¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤).

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
- **–î–æ—Å—Ç—É–ø**: –æ—Ç–∫—Ä—ã—Ç—ã–π –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏
- **–¢–æ–∫–µ–Ω—ã**: –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API (Tinkoff)

### –ó–∞—â–∏—Ç–∞ —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```bash
# ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
export T_INVEST_TEST_TOKEN=your_real_token
export SPRING_DATASOURCE_PASSWORD=your_real_password

# ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ - –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã
echo "T_INVEST_TEST_TOKEN=real_token" >> .env
```

### –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- API –∫–ª—é—á–∏ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
- JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- Rate limiting –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π
- HTTPS –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω –æ–∫—Ä—É–∂–µ–Ω–∏—è

## üìä –õ–∏–º–∏—Ç—ã –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ª–∏–º–∏—Ç—ã
- **–†–∞–∑–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞**: –º–∞–∫—Å–∏–º—É–º 10MB
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤ –∑–∞–ø—Ä–æ—Å–µ**: –º–∞–∫—Å–∏–º—É–º 1000
- **–í—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω**: –º–∞–∫—Å–∏–º—É–º 1 –≥–æ–¥
- **Rate limiting**: 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**: –º–∞–∫—Å–∏–º—É–º 10 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã**: –∫—ç—à–∏—Ä—É—é—Ç—Å—è –Ω–∞ 1 –¥–µ–Ω—å (Caffeine Cache)
- **–†–∞–∑–º–µ—Ä –∫—ç—à–∞**: –º–∞–∫—Å–∏–º—É–º 10,000 –∑–∞–ø–∏—Å–µ–π –Ω–∞ –∫—ç—à
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–≥—Ä–µ–≤**: –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **Fallback**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –ë–î –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –≤ –∫—ç—à–µ

### –ü—Ä–æ—Ñ–∏–ª–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
| –ü—Ä–æ—Ñ–∏–ª—å | –ü–æ—Ä—Ç | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | DevTools | –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ |
|---------|------|-------------|----------|-------------|
| `test` | 8087 | DEBUG | –í–∫–ª—é—á–µ–Ω—ã | –û—Ç–∫–ª—é—á–µ–Ω–æ |
| `prod` | 8083 | INFO | –û—Ç–∫–ª—é—á–µ–Ω—ã | –í–∫–ª—é—á–µ–Ω–æ |
| `docker` | 8083 | INFO | –û—Ç–∫–ª—é—á–µ–Ω—ã | –í–∫–ª—é—á–µ–Ω–æ |

## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –ö–æ–¥—ã –æ—à–∏–±–æ–∫
- `400 Bad Request` - –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- `404 Not Found` - —Ä–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω
- `429 Too Many Requests` - –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤
- `500 Internal Server Error` - –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞
- `503 Service Unavailable` - —Å–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

### –§–æ—Ä–º–∞—Ç –æ—à–∏–±–∫–∏
```json
{
  "error": "Bad Request",
  "message": "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä 'date'",
  "timestamp": "2024-01-15T10:30:00Z",
  "path": "/api/instruments/shares"
}
```

### –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á
–î–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `taskId`:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏
GET /api/system/logs?taskId=550e8400-e29b-41d4-a716-446655440000
```

## üîÑ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫—ç—à–∞
- **–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è**: Caffeine Cache (–≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π in-memory cache)
- **–°—Ç—Ä–∞—Ç–µ–≥–∏—è**: Cache-Aside —Å fallback –Ω–∞ –ë–î
- **TTL**: 1 –¥–µ–Ω—å (expireAfterWrite)
- **–†–∞–∑–º–µ—Ä**: –º–∞–∫—Å–∏–º—É–º 10,000 –∑–∞–ø–∏—Å–µ–π –Ω–∞ –∫—ç—à
- **–ê–ª–≥–æ—Ä–∏—Ç–º –≤—ã—Ç–µ—Å–Ω–µ–Ω–∏—è**: LRU (Least Recently Used)

### –¢–∏–ø—ã –∫—ç—à–µ–π
- **sharesCache** - –∫—ç—à –∞–∫—Ü–∏–π
- **futuresCache** - –∫—ç—à —Ñ—å—é—á–µ—Ä—Å–æ–≤  
- **indicativesCache** - –∫—ç—à –∏–Ω–¥–∏–∫–∞—Ç–∏–≤–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- **closePricesCache** - –∫—ç—à —Ü–µ–Ω –∑–∞–∫—Ä—ã—Ç–∏—è

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–µ–º
```bash
# –ü—Ä–æ–≥—Ä–µ–≤ –∫—ç—à–∞ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ)
POST /api/cache/warmup

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∫—ç—à–∞
GET /api/cache/content?cacheName=sharesCache&limit=100

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞
GET /api/cache/stats

# –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
DELETE /api/cache/clear?cacheName=sharesCache
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫—ç—à–∞
```json
{
  "totalCaches": 4,
  "activeCaches": 4,
  "totalEntries": 1247,
  "cacheDetails": {
    "sharesCache": {
      "entryCount": 150,
      "sampleEntries": [...]
    }
  }
}
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [–î–µ—Ç–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º](api/instruments.md)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Å–≤–µ—á–∞–º](api/candles.md)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ç–æ—Ä–≥–æ–≤—ã–º –¥–∞–Ω–Ω—ã–º](api/trading.md)
- [–°–∏—Å—Ç–µ–º–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](api/system.md)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∫—ç—à—É](api/cache.md)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
- [–ü–æ–ª–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞](../SETUP.md)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](../QUICK_START.md)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã](architecture.md)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](database.md)
- [Docker —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞](docker-development.md)

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- [–ó–∞—â–∏—Ç–∞ —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö](../SECURITY.md)
- [–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è](../ENV_VARIABLES.md)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞](../PRODUCTION.md)

## üö® –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ** —Ä–µ–∞–ª—å–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã API –∏–ª–∏ –ø–∞—Ä–æ–ª–∏ –ë–î
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ** –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ** .gitignore —Ñ–∞–π–ª –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **–¢–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ—Ñ–∏–ª—å** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Ä—Ç 8087 –∏ —Ç–µ—Å—Ç–æ–≤—ã–π —Ç–æ–∫–µ–Ω Tinkoff
- **–ü—Ä–æ–¥–∞–∫—à–Ω –ø—Ä–æ—Ñ–∏–ª—å** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Ä—Ç 8083 –∏ –ø—Ä–æ–¥–∞–∫—à–Ω —Ç–æ–∫–µ–Ω Tinkoff
- **Docker –ø—Ä–æ—Ñ–∏–ª—å** –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–ö—ç—à –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≥—Ä–µ–≤–∞–µ—Ç—Å—è** –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **Fallback –Ω–∞ –ë–î** –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –∫—ç—à–µ–º
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫
